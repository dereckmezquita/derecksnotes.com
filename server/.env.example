# =============================================================================
# Server Environment Variables
# =============================================================================
# Copy this file to .env and fill in the values
#
# ENVIRONMENTS:
#   LOCAL - Running on your local machine (bare metal, no Docker)
#   DEV   - Running on VPS in Docker (dev.derecksnotes.com)
#   PROD  - Running on VPS in Docker (derecksnotes.com)
# =============================================================================

# -----------------------------------------------------------------------------
# BUILD ENVIRONMENT
# -----------------------------------------------------------------------------
# Values: 'PROD' | 'DEV' | 'LOCAL'
# Controls: logging verbosity, cookie security, URL construction
BUILD_ENV=LOCAL

# -----------------------------------------------------------------------------
# NETWORK CONFIGURATION
# -----------------------------------------------------------------------------
# Domain used for cookie settings and URL construction
# LOCAL: localhost
# DEV: dev.derecksnotes.com
# PROD: derecksnotes.com
DOMAIN=localhost

# Port the server listens on
# LOCAL: 3001 (or any available port)
# DEV: 3001 (mapped via Docker)
# PROD: 3003 (mapped via Docker)
#
# NOTE: In Docker, the container always listens on 3000 internally.
# The PORT_MAP_SERVER in docker-compose maps external port to internal 3000.
# This variable is only used for LOCAL development.
PORT_SERVER=3001

# Port the client runs on (used for CORS and URL construction)
# LOCAL: 3000
# DEV: 3000
# PROD: 3002
#
# TODO: [REVIEW] This seems redundant - the server shouldn't need to know
# the client port. CORS should just allow the domain, not domain:port.
PORT_CLIENT=3000

# -----------------------------------------------------------------------------
# SESSION / AUTHENTICATION
# -----------------------------------------------------------------------------
# Secret key for encrypting session cookies
# Generate with: openssl rand -base64 32
# REQUIRED: Must be set in all environments
SESSION_SECRET=replace_with_a_secure_random_string

# -----------------------------------------------------------------------------
# MONGODB
# -----------------------------------------------------------------------------
# MongoDB host
# LOCAL: 127.0.0.1 or localhost
# DEV/PROD: Docker container name (e.g., linode_dereck-mongodb) or IP
#
# TODO: [REVIEW] Consider using a full connection string (MONGO_URL) instead
# of separate host/password/database. More standard and flexible.
MONGO_URI=127.0.0.1

# MongoDB password (will be URL-encoded automatically)
# REQUIRED: Must be set in all environments
MONGO_PASSWORD=your_password_here

# MongoDB database name
# LOCAL: local_derecksnotes
# DEV: dev_derecksnotes
# PROD: prod_derecksnotes
MONGO_DATABASE=local_derecksnotes

# -----------------------------------------------------------------------------
# REDIS
# -----------------------------------------------------------------------------
# Redis connection URI for session storage
# LOCAL: redis://localhost:6379
# DEV/PROD: redis://container_name:6379 or redis://IP:6379
#
# NOTE: Currently no authentication configured for Redis
REDIS_URI=redis://localhost:6379

# -----------------------------------------------------------------------------
# EXTERNAL SERVICES
# -----------------------------------------------------------------------------
# SendGrid API key for sending emails (verification, password reset, etc.)
# REQUIRED: Must be set in all environments
# Get from: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY=your_sendgrid_api_key_here

# =============================================================================
# ANALYSIS / RECOMMENDATIONS
# =============================================================================
#
# ISSUES IDENTIFIED:
#
# 1. PORT_CLIENT is redundant
#    The server doesn't need to know what port the client runs on.
#    CORS should be domain-based, not port-based.
#    RECOMMENDATION: Remove this variable.
#
# 2. PORT_SERVER has different meanings in different contexts
#    - LOCAL: The actual port the server listens on
#    - DOCKER: Container always listens on 3000, this is ignored
#    The workflows set PORT_SERVER=3000 which is confusing.
#    RECOMMENDATION: Rename to PORT or simplify to always use 3000.
#
# 3. MONGO_URI is not a URI
#    It's actually just a hostname. The name is misleading.
#    RECOMMENDATION: Rename to MONGO_HOST or use a full connection string.
#
# 4. No MONGO_PORT or MONGO_USER variables
#    These are hardcoded somewhere. Should be configurable.
#    RECOMMENDATION: Add MONGO_PORT, MONGO_USER or use full connection string.
#
# 5. BUILD_ENV controls too many things
#    It controls: logging, cookie security, URL scheme (http vs https), etc.
#    RECOMMENDATION: Consider separate flags like NODE_ENV, SECURE_COOKIES, etc.
#
# 6. API_PREFIX is hardcoded as '/' in env.ts
#    It's defined as a constant, not an env var, but workflows mention it.
#    RECOMMENDATION: Either make it configurable or remove from documentation.
#
# =============================================================================
